<!--/*@thymesVar id="question" type="services.applicant.question.ApplicantQuestion"*/-->
<!--/*@thymesVar id="questionRendererParams" type="views.questiontypes.ApplicantQuestionRendererParams"*/-->

<div
  th:fragment="map(question, questionRendererParams)"
  th:with="mapQuestion=${question.createMapQuestion()},
             questionId=${'id-' + #strings.randomAlphanumeric(8)},
              mapId=${'cf-map-' + #strings.randomAlphanumeric(8)},
              firstPathWithError=${mapQuestion.getFirstPathWithError()},
             hasGroupErrors=${mapQuestion.getValidationErrors().get(question.getContextualizedPath())},"
  th:id="${questionId}"
  class="cf-question-map"
  th:classappend="${hasGroupErrors ? 'cf-question-field-with-error' : ''}"
  data-testid="questionRoot"
>
  <!-- TODO(#11003): Build out applicant view of map question -->
  <div th:id="${mapId}" class="square-mobile"></div>
  <div
    th:data-mapid="|${mapId}|"
    class="hidden"
    th:if="${questionRendererParams.geoJson().isPresent()}"
    th:value="${questionRendererParams.geoJson().get()}"
  ></div>
  <script th:inline="javascript" th:nonce="${cspNonce}">
    window.app = window.app || {}
    window.app.data = window.app.data || {}
    window.app.data.maps = window.app.data.maps || {}

    id = /*[[${mapId}]]*/ 'id'
    if (
      /*[[${questionRendererParams.geoJson().isPresent()}]]*/ mapDataIsPresent
    ) {
      window.app.data.maps[id] =
        /*[[${questionRendererParams.geoJson().get()}]]*/ {}
    }
  </script>
</div>
