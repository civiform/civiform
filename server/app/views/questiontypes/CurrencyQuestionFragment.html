<div
  th:fragment="currency(question, questionRendererParams)"
  th:with="currencyQuestion=${question.createCurrencyQuestion()},
             questionId=${'id-' + #strings.randomAlphanumeric(8)},
             inputId=${'id-' + #strings.randomAlphanumeric(8)},
             fieldErrors=${currencyQuestion.getValidationErrors().get(currencyQuestion.getCurrencyPath())},
             questionErrors=${currencyQuestion.getValidationErrors().get(question.getContextualizedPath())},
             allErrors=${currencyQuestion.getValidationErrors().values()}"
  th:id="${questionId}"
  th:class="padding-left-105"
  th:classappend="${allErrors == null || allErrors.isEmpty() ? '' : 'border-secondary-dark border-left-width-05'}"
  >
  <!--/* Title and Help Text */-->
  <div
    th:replace="~{questiontypes/QuestionBaseFragment :: titleAndHelpTextSingleInput(${question}, ${questionId}, ${inputId})}"
  ></div>

  <!--/* Display errors */-->
  <div
    th:replace="~{questiontypes/QuestionBaseFragment :: validationErrors(${questionErrors})}"
  ></div>
  <div
    th:replace="~{questiontypes/QuestionBaseFragment :: validationErrors(${fieldErrors})}"
  ></div>

  <div class="usa-input-group"
      th:classappend="${allErrors == null || allErrors.isEmpty() ? '' : 'usa-input-group--error'}"
  >
    <div class="usa-input-prefix">$</div>
    <input
      th:with="value=${currencyQuestion.getCurrencyValue().isPresent() ?
                                currencyQuestion.getCurrencyValue().get().prettyPrint() :
                                currencyQuestion.getFailedUpdates().getOrDefault(currencyQuestion.getCurrencyPath(), '')}"
      class="usa-input"
      inputmode="decimal"
      currency
      th:id="${inputId}"
      th:name="${currencyQuestion.getCurrencyPath()}"
      th:value="${value}"
      th:aria-describedby="${questionId} + '-description'"
      th:aria-required="${!question.isOptional()}"
      th:aria-invalid="${!currencyQuestion.getValidationErrors().isEmpty()}"
      th:autofocus="${questionRendererParams.autofocusFirstError()}"
    />
  </div>
</div>
