
## Filter Configuration
# https://www.playframework.com/documentation/latest/Filters
# ~~~~~
# There are a number of built-in filters that can be enabled and configured
# to give Play greater security.
#
play.filters {
  enabled += com.github.stijndehaes.playprometheusfilters.filters.StatusAndRouteLatencyAndCounterFilter
  enabled += filters.DisableCachingFilter
  enabled += filters.HSTSFilter
  enabled += filters.LoggingFilter
  enabled += filters.ValidAccountFilter
  enabled += play.filters.gzip.GzipFilter
  enabled += filters.UnsupportedBrowserFilter

  gzip {
    threshold = 1000        # don't compress very small responses
    compressionLevel = -1   # -1 is the default compression level (level 6)
    contentType {
      # If non empty, then a response will only be compressed if its content type is in this list.
      whiteList = [ "text/*", "application/javascript", "application/json" ]
    }
  }

  # Enable URL path regex-matching for determining different security logic.
  # Docs: https://github.com/pac4j/play-pac4j/wiki/Apply-security#2-protect-urls-via-the-securityfilter
  # See pac4j.security.rules configuration value above.
  enabled += org.pac4j.play.filters.SecurityFilter

  # This MUST come after org.pac4j.play.filters.SecurityFilter since it relies
  # on the security logic setting ApiKey ID as the profile ID on the request object.
  enabled += filters.ApiKeyUsageFilter

  ## CORS filter configuration
  # https://www.playframework.com/documentation/latest/CorsFilter
  # ~~~~~
  # CORS is a protocol that allows web applications to make requests from the browser
  # across different domains.
  # NOTE: You MUST apply the CORS configuration before the CSRF filter, as CSRF has
  # dependencies on CORS settings.
  cors {
    # Filter paths by a whitelist of path prefixes
    #pathPrefixes = ["/some/path", ...]

    # The allowed origins. If null, all origins are allowed.
    #allowedOrigins = ["http://www.example.com"]

    # The allowed HTTP methods. If null, all methods are allowed
    #allowedHttpMethods = ["GET", "POST"]
  }

  ## CSRF Filter
  # https://www.playframework.com/documentation/latest/ScalaCsrf#Applying-a-global-CSRF-filter
  # https://www.playframework.com/documentation/latest/JavaCsrf#Applying-a-global-CSRF-filter
  # ~~~~~
  # Play supports multiple methods for verifying that a request is not a CSRF request.
  # The primary mechanism is a CSRF token. This token gets placed either in the query string
  # or body of every form submitted, and also gets placed in the users session.
  # Play then verifies that both tokens are present and match.
  csrf {
    # Sets the cookie to be sent only over HTTPS
    cookie.secure = true

    # Defaults to CSRFErrorHandler in the root package.
    #errorHandler = MyCSRFErrorHandler

    token.sign = true
  }

  ## Security headers filter configuration
  # https://www.playframework.com/documentation/latest/SecurityHeaders
  # ~~~~~
  # Defines security headers that prevent XSS attacks.
  # If enabled, then all options are set to the below configuration by default:
  headers {
    # The X-Frame-Options header. If null, the header is not set.
    frameOptions = "SAMEORIGIN"

    # The X-XSS-Protection header. If null, the header is not set.
    #xssProtection = "1; mode=block"

    # The X-Content-Type-Options header. If null, the header is not set.
    #contentTypeOptions = "nosniff"

    # The X-Permitted-Cross-Domain-Policies header. If null, the header is not set.
    #permittedCrossDomainPolicies = "master-only"

    # The Content-Security-Policy header. If null, the header is not set.
    #contentSecurityPolicy = "default-src 'self'"
  }

  ## Allowed hosts filter configuration
  # https://www.playframework.com/documentation/latest/AllowedHostsFilter
  # ~~~~~
  # Play provides a filter that lets you configure which hosts can access your application.
  # This is useful to prevent cache poisoning attacks.
  hosts {
    # Allow requests to localhost on ports 9000 (dev) and 19001 (default test) ports
    # Also allow any host until we get our own domain.
    allowed = ["localhost:9000", "localhost:9999", "localhost:19001", "."]
  }
}
