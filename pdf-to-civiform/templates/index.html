<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PDF to CiviForm JSON Converter</title>
    <script>
        async function uploadFile(event) {
            event.preventDefault();
            const fileInput = document.getElementById("pdfFile");
            const file = fileInput.files[0];
            if (!file) {
                alert("Please select a PDF file containing program form.");
                return;
            }

            const formData = new FormData();
            formData.append("file", file);

            // Get the selected LLM model name
            const modelName = document.getElementById("LLMModelSelect").value;
            formData.append("modelName", modelName); // Add modelId to form data

            document.getElementById("output").innerText = "Processing...";
            
            try {
                const response = await fetch("/upload", {
                    method: "POST",
                    body: formData
                });
                
                const data = await response.json();
                if (response.ok) {
                    document.getElementById("output").innerText = JSON.stringify(data, null, 2);
                } else {
                    document.getElementById("output").innerText = `Error: ${data.error}`;
                }
            } catch (error) {
                document.getElementById("output").innerText = `Request failed: ${error}`;
            }
        }
    </script>
</head>
<body>
    <h1>PDF to CiviForm JSON Converter</h1>

    <p>
        <b>Instructions:</b>
        <ol>
            <li>Select a PDF file containing the program form you want to convert.</li>
            <li>Click "Convert" to process the PDF and generate the CiviForm JSON output.</li>
            <li>Copy the CiviForm JSON output and import to CiviForm.</li>
        </ol>
    </p>

    <form onsubmit="uploadFile(event)">
        <input type="file" id="pdfFile" accept="application/pdf" required>

        <select id="LLMModelSelect">
            <option value="gemini-2.0-pro-exp-02-05">gemini-2.0-pro-exp-02-05</option>
            <option value="gemini-2.0-flash-exp">gemini-2.0-flash-exp</option>
            <option value="gemini-2.0-flash-thinking-exp-01-21">gemini-2.0-flash-thinking-exp-01-21</option>
            <option value="gemini-1.5-pro">gemini-1.5-pro</option>
            <option value="gemini-2.0-flash-lite-preview-02-05">gemini-2.0-flash-lite-preview-02-05</option>
            </select>

        <button type="submit">Convert</button>
    </form>
    <h2>Output JSON:</h2>
    <pre id="output"></pre>
</body>
</html>
